package mithril

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestCardanoTransactionsProofsMessageVerify01(t *testing.T) {
	ctpm := &CardanoTransactionsProofsMessage{
		CertificateHash: "228c3bb545739761bf1cd67d5eebf6b3b3952d85364ff8401352346b42b50d07",
		CertifiedTransactions: []*CardanoTransactionsSetProofMessagePart{
			{
				TransactionsHashes: []string{
					"6a3879ad36df335e94003f2e8c3a126171af16679c7eaac542c4353ad04ffc8f",
				},
				Proof: "7b226d61737465725f70726f6f66223a7b22696e6e65725f726f6f74223a7b2268617368223a5b3233362c34352c32352c31352c38342c35362c3134302c3139382c39322c3132332c31362c3139322c39342c372c3131362c32312c39322c3230382c34312c3230382c3234352c3134312c35392c37312c3133372c3136362c33362c32332c3130372c37332c31372c36315d7d2c22696e6e65725f6c6561766573223a5b5b382c7b2268617368223a5b3132352c3230312c38322c3131312c3137332c39352c32382c31332c3133312c33362c3234352c3231302c3235302c39342c32302c302c3232342c31382c37342c34392c36352c3231312c38382c3135332c37322c3132332c3139352c33382c39392c37342c3130332c3131335d7d5d5d2c22696e6e65725f70726f6f665f73697a65223a31302c22696e6e65725f70726f6f665f6974656d73223a5b7b2268617368223a5b3232322c34382c32352c3138312c3137312c31322c3231332c332c3139392c332c34332c3133302c3137322c3230342c3232312c3232372c3137352c3133382c38312c3135362c3135312c3134372c33332c3133352c3136312c34302c3235342c3131352c3131362c3133392c32352c3134335d7d2c7b2268617368223a5b3135312c38372c35362c3133352c39322c3139382c37322c3130352c3235322c3136362c3135342c38322c38302c3234372c3139372c3230372c38302c3131332c35372c322c35372c3132312c34352c3234332c38372c352c3232322c36302c3131392c3132392c35352c37385d7d5d7d2c227375625f70726f6f6673223a5b5b7b22696e6e65725f72616e6765223a7b227374617274223a333837302c22656e64223a333838357d7d2c7b226d61737465725f70726f6f66223a7b22696e6e65725f726f6f74223a7b2268617368223a5b35342c39372c35312c35362c35352c35372c39372c3130302c35312c35342c3130302c3130322c35312c35312c35332c3130312c35372c35322c34382c34382c35312c3130322c35302c3130312c35362c39392c35312c39372c34392c35302c35342c34392c35352c34392c39372c3130322c34392c35342c35342c35352c35372c39392c35352c3130312c39372c39372c39392c35332c35322c35302c39392c35322c35312c35332c35312c39372c3130302c34382c35322c3130322c3130322c39392c35362c3130325d7d2c22696e6e65725f6c6561766573223a5b5b302c7b2268617368223a5b35342c39372c35312c35362c35352c35372c39372c3130302c35312c35342c3130302c3130322c35312c35312c35332c3130312c35372c35322c34382c34382c35312c3130322c35302c3130312c35362c39392c35312c39372c34392c35302c35342c34392c35352c34392c39372c3130322c34392c35342c35342c35352c35372c39392c35352c3130312c39372c39372c39392c35332c35322c35302c39392c35322c35312c35332c35312c39372c3130302c34382c35322c3130322c3130322c39392c35362c3130325d7d5d5d2c22696e6e65725f70726f6f665f73697a65223a312c22696e6e65725f70726f6f665f6974656d73223a5b5d7d2c227375625f70726f6f6673223a5b5d7d5d5d7d",
			},
		},
		NonCertifiedTransactions:  []string{},
		LatestImmutableFileNumber: 17,
	}
	verifiedtTx, err := ctpm.Verify()
	assert.NoError(t, err)
	assert.NotNil(t, verifiedtTx)
}

func TestCardanoTransactionsProofsMessageVerify02(t *testing.T) {
	ctpm := &CardanoTransactionsProofsMessage{
		CertificateHash: "1df719dd86c9ab5af261f0d42c698e84c13e9480960ed00764c875ee86bbfa66",
		CertifiedTransactions: []*CardanoTransactionsSetProofMessagePart{
			{
				TransactionsHashes: []string{
					"e7abdac3957982c460ba8c3d1cf60bdd45c4cdf01c8872ad15653061b01a2427",
				},
				Proof: "7b226d61737465725f70726f6f66223a7b22696e6e65725f726f6f74223a7b2268617368223a5b34302c3135352c3138342c3235352c36392c38312c32342c3131382c36382c3135392c3137362c3235342c33322c3234382c31362c38332c3231322c33362c37322c3234372c32392c3136382c38342c36342c3133392c342c3132362c3139392c3131392c33382c3130302c35355d7d2c22696e6e65725f6c6561766573223a5b5b3232382c7b2268617368223a5b3133302c3138392c3135322c3233312c3135382c3131342c3135312c33382c35362c3133322c3130342c372c3139332c3131362c3235312c3235322c32352c362c3135322c3132312c3130342c3137342c37302c35342c39352c35332c3235332c3132362c3133382c3234382c3231352c3133315d7d5d5d2c22696e6e65725f70726f6f665f73697a65223a3234372c22696e6e65725f70726f6f665f6974656d73223a5b7b2268617368223a5b35372c3132302c37312c38352c392c3136362c33352c3136352c3232302c39352c3139322c33302c3233342c3231372c38392c36342c3234372c3132352c3231322c3230322c37362c3133322c3136332c32392c3138362c32372c3231302c3131342c38302c38342c3131362c3134315d7d2c7b2268617368223a5b3130352c3233352c3138342c3136302c3230362c392c3232372c3230352c3230322c3134332c34342c392c3130322c38302c3233372c37352c3138322c3230322c3133352c3234362c34372c3132312c31392c36312c35342c3233382c38342c32372c3131332c36352c36342c38315d7d2c7b2268617368223a5b3233372c3235332c3231392c3232322c3133342c332c3231302c3135302c3230342c3135302c3231372c39362c3234322c3130372c38362c39382c382c3139312c3232342c38302c3132312c372c3232382c3130302c3139312c39372c3130312c3134392c3139322c39302c35302c37395d7d2c7b2268617368223a5b3134312c312c37382c3232332c3131312c36372c3233322c36322c3233312c38342c35392c3138382c37352c3136362c38302c3138342c3235352c35362c3131362c3139332c3133362c3230312c3133382c3134312c3235312c31392c3231392c3234322c3234382c3134372c36392c3137345d7d2c7b2268617368223a5b3234392c3138362c37342c33342c3139372c3138312c3232302c3131302c322c3234312c3132362c3230312c3232372c35352c3230302c3232382c3132382c3132382c3130342c3132332c31342c3135322c36372c3139302c3130342c322c3132312c3234312c3132372c33392c3138302c36345d7d2c7b2268617368223a5b33342c39302c3133302c36342c3130322c3135322c3233352c3139392c33332c38352c3134302c34312c3233332c3131322c3234332c3131312c3138372c38362c3131322c3136342c33362c3137342c3232332c3133312c3130382c32392c3233312c3134332c342c3134362c3139312c32325d7d2c7b2268617368223a5b3231392c3230332c3134392c3138312c37382c3130302c3137392c3138362c3134372c38332c34322c3136302c3131352c31302c39372c3134352c3131302c38352c31342c33332c33362c3138392c342c3137382c3131372c32362c34302c3131312c3132392c3136362c3134352c3139395d7d5d7d2c227375625f70726f6f6673223a5b5b7b22696e6e65725f72616e6765223a7b227374617274223a39333837302c22656e64223a39333838357d7d2c7b226d61737465725f70726f6f66223a7b22696e6e65725f726f6f74223a7b2268617368223a5b3233392c3132322c3134322c3232322c3230322c38362c3132332c38332c39392c3234382c31372c31362c3130372c3136362c3138342c3230372c3137372c32342c3231392c392c3235332c31372c39312c3231342c39352c3139392c39362c31322c34332c3133302c3130372c33385d7d2c22696e6e65725f6c6561766573223a5b5b312c7b2268617368223a5b3130312c35352c39372c39382c3130302c39372c39392c35312c35372c35332c35352c35372c35362c35302c39392c35322c35342c34382c39382c39372c35362c39392c35312c3130302c34392c39392c3130322c35342c34382c39382c3130302c3130302c35322c35332c39392c35322c39392c3130302c3130322c34382c34392c39392c35362c35362c35352c35302c39372c3130302c34392c35332c35342c35332c35312c34382c35342c34392c39382c34382c34392c39372c35302c35322c35302c35355d7d5d5d2c22696e6e65725f70726f6f665f73697a65223a32362c22696e6e65725f70726f6f665f6974656d73223a5b7b2268617368223a5b3130312c3130312c39382c3130312c35352c35302c35322c35312c35302c34392c39372c3130322c35342c35312c35342c35332c3130322c35332c35352c39372c35322c35342c3130312c3130312c35352c39392c35332c39382c3130322c35372c35352c35312c3130312c39382c3130312c39372c3130312c39382c35352c3130322c34382c3130312c35352c39392c34382c35312c34392c35342c35312c34392c34392c39372c35362c35332c35352c35342c39372c35372c39372c35322c35362c35332c35322c3130305d7d2c7b2268617368223a5b3134342c3133332c35342c3131332c3234392c3232392c3136352c3234332c34332c3234382c38332c31332c39382c3137302c33372c3134332c3138312c33362c3132302c372c35332c3233322c3130392c33362c3132392c34332c3139352c3136342c3234382c3134352c35382c38395d7d2c7b2268617368223a5b36302c3138302c36372c3235342c33382c3131362c3138302c3132332c3137322c32302c3130362c3233372c3231362c352c37332c3138322c3134372c39312c33362c372c3233322c3235332c3134342c3234352c37342c35302c3139392c3133362c3139332c3133312c3137372c36395d7d2c7b2268617368223a5b37312c3235352c3234392c3234362c38302c37362c37322c37362c3231342c36322c3233332c32362c3230342c3131382c31332c3230302c3131312c36352c3139352c36302c3139302c3134342c3135302c3134352c31322c34332c36352c34312c32352c3235342c39352c3138385d7d5d7d2c227375625f70726f6f6673223a5b5d7d5d5d7d",
			},
		},
		NonCertifiedTransactions:  []string{},
		LatestImmutableFileNumber: 669,
	}
	verifiedTx, err := ctpm.Verify()
	assert.NoError(t, err)
	assert.NotNil(t, verifiedTx)
}
